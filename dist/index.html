<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>PDF Viewer Example</title>
        <script defer="defer" src="pdf.js"></script>
        <script defer="defer" src="pdf_viewer.js"></script>
        <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
        <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
        <style>
            #pdfviewer-slide-wrapper-container {
                width: 100% !important;
            }

            .page {
                border: 0 !important;
                margin: 0 auto !important;
            }
        </style>
    </head>

    <body>
        <div id="pdfviewer-slide-wrapper-container" class="swiper viewerContainer">
            <div class="pdfViewer swiper-wrapper"></div>
        </div>
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>

        <!-- <div id="rt-cards-wrapper">
      <div
        id="pdfviewer-cards-wrapper-container"
        class="swiper viewerContainer"
      >
        <div class="pdfViewer swiper-wrapper"></div>
      </div>
      <div class="swiper-button-prev"></div>
      <div class="swiper-button-next"></div>
    </div>

    <div id="rt-fade-wrapper">
      <div id="pdfviewer-fade-wrapper-container" class="swiper viewerContainer">
        <div class="pdfViewer swiper-wrapper"></div>
      </div>
      <div class="swiper-button-prev"></div>
      <div class="swiper-button-next"></div>
    </div>

    <div id="rt-cube-wrapper">
      <div id="pdfviewer-cube-wrapper-container" class="swiper viewerContainer">
        <div class="pdfViewer swiper-wrapper"></div>
      </div>
      <div class="swiper-button-prev"></div>
      <div class="swiper-button-next"></div>
    </div>

    <div id="rt-flip-wrapper">
      <div id="pdfviewer-flip-wrapper-container" class="swiper viewerContainer">
        <div class="pdfViewer swiper-wrapper"></div>
      </div>
      <div class="swiper-button-prev"></div>
      <div class="swiper-button-next"></div>
    </div>

    <div id="rt-coverflow-wrapper">
      <div
        id="pdfviewer-coverflow-wrapper-container"
        class="swiper viewerContainer"
      >
        <div class="pdfViewer swiper-wrapper"></div>
      </div>
      <div class="swiper-button-prev"></div>
      <div class="swiper-button-next"></div>
    </div>

    <div id="rt-creative-wrapper">
      <div
        id="pdfviewer-creative-wrapper-container"
        class="swiper viewerContainer"
      >
        <div class="pdfViewer swiper-wrapper"></div>
      </div>
      <div class="swiper-button-prev"></div>
      <div class="swiper-button-next"></div>
    </div> -->

        <script>
            class SwiperPDF {
                PDFViewer = window.rtPDFViewer;
                rtContainerId = null;
                containerId = null;
                effect = null;
                swiper = null;
                constructor(effect = 'slide') {
                    this.effect = effect;
                    this.rtContainerId = `rt-${this.effect}-wrapper`;
                    this.containerId = `pdfviewer-${this.effect}-wrapper-container`;
                    this.initPDFViewer();
                }

                render = () => {
                    return new Promise((resolve) => {
                        this.PDFViewer.eventBus.on('pagesloaded', (val) => {
                            if (val.source.container.id === this.containerId) {
                                this.initSwiper({
                                    afterInit: resolve
                                });
                            }
                        });
                    });
                };

                initPDFViewer() {
                    this.PDFViewer.initialize({
                        containerId: this.containerId
                    });

                    this.PDFViewer.open('tech.pdf');
                }

                initSwiper(eventBus) {
                    const swiper = document.querySelector(`#${this.containerId}.swiper`);
                    const pages = document.querySelectorAll(`#${this.containerId} .page-slide`);

                    pages.forEach((page) => {
                        page.classList.add('swiper-slide');
                        swiper.style.width = page.style.width;
                        swiper.style.height = page.style.height;
                    });

                    const conf = {
                        centeredSlides: true,
                        centeredSlidesBounds: true,
                        on: eventBus,
                        effect: this.effect,
                        grabCursor: true,
                        navigation: {
                            nextEl: `.swiper-button-next`,
                            prevEl: `.swiper-button-prev`
                        },
                        keyboard: {
                            enabled: true,
                            onlyInViewport: true
                        }
                    };

                    if (this.effect === 'creative') {
                        conf.creativeEffect = {
                            prev: {
                                shadow: true,
                                origin: 'left center',
                                translate: ['-5%', 0, -200],
                                rotate: [0, 100, 0]
                            },
                            next: {
                                origin: 'right center',
                                translate: ['5%', 0, -200],
                                rotate: [0, -100, 0]
                            }
                        };
                    }

                    console.log('conf', conf);

                    this.swiper = new Swiper(`#${this.containerId}.swiper`, conf);
                }
            }

            document.addEventListener('DOMContentLoaded', async () => {
                await new SwiperPDF('slide').render();

                // await new SwiperPDF("cards").render();
                // await new SwiperPDF("fade").render();
                // await new SwiperPDF("cube").render();
                // await new SwiperPDF("flip").render();
                // await new SwiperPDF("coverflow").render();
                // await new SwiperPDF("creative").render();
            });
        </script>
    </body>
</html>
