<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>PDF Viewer Example</title>
    <script defer="defer" src="pdf.js"></script>
    <script defer="defer" src="pdf_viewer.js"></script>
    <link
      rel="stylesheet"
      href="https://unpkg.com/swiper/swiper-bundle.min.css"
    />
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <style>
      .viewerContainer {
        overflow: visible !important;
      }
      .pdfViewer .page {
        border: 0 !important;
        margin: 0 !important;
      }

      .textLayer {
        display: none;
      }
    </style>
  </head>

  <body>
    <div style="position: relative; width: 100%; height: 100%">
      <div id="rt-cards-wrapper-container" class="swiper viewerContainer">
        <div class="pdfViewer swiper-wrapper"></div>
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
      </div>
    </div>

    <div style="position: relative; width: 100%; height: 100%; top: 800px">
      <div id="rt-slide-wrapper-container" class="swiper viewerContainer">
        <div class="pdfViewer swiper-wrapper"></div>
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
      </div>
    </div>

    <script>
      class SwiperPDF {
        containerId = null;
        effect = null;
        constructor(conf = {}) {
          this.containerId = conf.containerId;
          this.effect = conf.effect;

          this.initPDFViewer();
        }

        render = async () => {
          return await new Promise((resolve) => {
            window.rtPDFViewer.eventBus.on("pagesloaded", (val) => {
              if (val.source.container.id === this.containerId) {
                this.initSwiper(resolve);
              }
            });
          });
        };

        initPDFViewer() {
          window.rtPDFViewer.initialize({
            containerId: this.containerId,
            isDefaultWorker: true,
            spreadMode: 0,
            scale: "page-fit",
          });

          window.rtPDFViewer.open("tech.pdf");
        }

        initSwiper(resolve) {
          const swiper = document.querySelector(`#${this.containerId}.swiper`);
          const pages = document.querySelectorAll(
            `#${this.containerId}>.pdfViewer>.page`
          );

          pages.forEach((page) => {
            page.classList.add("swiper-slide");
            swiper.style.width = page.style.width;
            swiper.style.height = page.style.height;
          });

          new Swiper(`#${this.containerId}.swiper`, {
            on: {
              afterInit: resolve,
            },
            effect: this.effect,
            grabCursor: true,
            centeredSlides: true,
            navigation: {
              nextEl: `#${this.containerId}>.swiper-button-next`,
              prevEl: `#${this.containerId}>.swiper-button-prev`,
            },
          });
        }
      }

      const effects = [
        {
          containerId: "rt-cards-wrapper-container",
          effect: "cards",
        },
        {
          containerId: "rt-slide-wrapper-container",
          effect: "slide",
        },
      ];

      document.addEventListener("DOMContentLoaded", async () => {
        await new SwiperPDF(effects[0]).render();
        await new SwiperPDF(effects[1]).render();
      });
    </script>
  </body>
</html>
